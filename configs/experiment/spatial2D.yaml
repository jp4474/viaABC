# @package _global_

# to execute this experiment run:
# python train.py experiment=example

defaults:
  - override /data: spatial2D
  - override /model: spatial2D
  - override /callbacks: default
  - override /trainer: default

# all parameters below will be merged with parameters from default configurations set above
# this allows you to overwrite only specified parameters

tags: ["spatial2D", "MAE"]

hydra:
  run:
    dir: ${paths.log_dir}/${task_name}/runs/spatial2D_VAE

seed: 12345

trainer:
  max_steps: 300000
  fast_dev_run: false 
  precision: 32-true
  log_every_n_steps: 10
  max_epochs: -1
  gradient_clip_val: 10.0

model:
  net:
    patch_size: 16
    embed_dim: 384
    depth: 12
    in_chans: 6
    out_chans: 6
    num_heads: 6
    decoder_embed_dim: 256
    decoder_depth: 4
    decoder_num_heads: 8
    mlp_ratio: 4.0
    mask_ratio: 0.75
    kld_weight: 1.0

  optimizer:
    betas: [0.9, 0.995]
    lr: 0.000001
    weight_decay: 0.05

  scheduler:
    warmup_steps: 30000
    max_steps: ${trainer.max_steps}
    min_lr: 0.000001
    max_lr: 0.0002

  compile: true
  vae_warmup_steps: 60000
  annealing: true # false means no annealing

data:
  batch_size: 16
  num_workers: 8
  pin_memory: true

# torch:
#   matmul_precision: high
#   allow_tf32: true

model_checkpoint:
  monitor: val/loss
  every_n_train_steps: 50000
  save_last: true